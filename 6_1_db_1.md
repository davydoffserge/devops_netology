# devops-netology
## Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

* Электронные чеки в json виде
* Склады и автомобильные дороги для логистической компании
* Генеалогические деревья
* Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
* Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

Ответ:
* ЭЛЕКТРОННЫЕ ЧЕКИ
Документно-ориентированные базы данных.
Эти базы данных предоставляют возможность хранения сложных вложенных документов, в то время как большинство реляционных
баз данных поддерживает лишь одномерные строки. Такая возможность может пригодиться во многих случаях, например, 
при необходимости хранения в системе информации о пользователе с несколькими адресами. 
При использовании документно-ориентированной базы данных, в подобном случае можно просто хранить сложный объект, 
включающий массив адресов, в то время как в реляционной базе данных вам пришлось бы создать две таблицы: 
одну для информации о пользователе, а вторую для адресов.

Документно-ориентированные базы данных позволяют сократить разрыв между объектной моделью и моделью данных. 
Некоторые реляционные базы данных, такие как PostgreSQL, теперь тоже поддерживают документно-ориентированное хранилище, 
но в большинстве реляционных баз данных эта возможность всё еще отсутствует. Документные или документно-ориентированные 
СУБД - это одна из наиболее популярных разновидностей NoSQL СУБД, где основной единицей логической модели данных 
является документ - структурированный текст, с определенным синтаксисом.

* СКЛАДЫ И АВТОМОБИЛЬНЫЕ ДОРОГИ

Для  этого варианта можно предложить использование графовых БД. т.е. можно учитывать средню скорость в пути и растояние 
между складами, или различные пути следования (маршруты)...
* Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
СУБД временных рядов

Эта СУБД оптимизирована для хранения данных с метками времени или данных временных рядов. Данные временных рядов содержат
измерения или события, которые отслеживаются, собираются или объединяются за определенный период времени.
Основная область применения таких СУБД - мониторинг, обработка телеметрии и финансовые системы.
* Генеалогические деревья

Соответствено необходимо использовать иерархичаские БД. Позволяющие однозначно определиь Кто есть чей Прародитель. 
Записи связаны друг с другом через связи в отношениях родитель-потомок. В иерархической модели базы данных 
каждая дочерняя запись имеет только одного родителя. Родитель может иметь несколько детей.
* Отношения клиент-покупка для интернет-магазина

Наверное в этом случае выгоднее всего использовать реляционные БД.  Можем обрабатывать данные покупок клиентов, 
начиная от стоимости заказа, предпочтений клиента в плане цвета и т.д...
(если мы продаем одежду или обувь) и дня недели, можем отправить постоянным клиентам СМС сообщения за пару дней 
до планируемой покупки с "обещанием" скидки на "определенного" вида товары, необходимые только для "ЛЮБИМОГО" клиента,
исходя из выборки.  

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. 
Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт -это отдельная реализация вашей системы 
и для каждого пункта надо привести классификацию):

* Данные записываются на все узлы с задержкой до часа (асинхронная запись)
* При сетевых сбоях, система может разделиться на 2 раздельных кластера
* Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

Ответ:

1 - AP-система (Availability + Partition tolerance – Consistency) не гарантирует целостность данных, обеспечивая
их доступность и устойчивость к разделению, например, как в распределённых веб-кэшах и DNS. 
Считается, что большинство NoSQL-СУБД относятся к этому классу систем, обеспечивая лишь некоторой уровень 
согласованности данных в конечном счете (eventually consistent). 
Таким образом, AP-система может быть представлена кластером из нескольких узлов, каждый из которых может принимать данные,
но не обязуется в тот же момент распространять их на другие сервера. Такая система отлично справляется с отказами 
нескольких узлов, но, когда они снова начинают работать, возможна выдача пользователям старых данных.

2 - CA-система (Availability + Consistency – Parition tolerance), когда данные во всех узлах кластера согласованы и доступны,
но не устойчивы к разделению. 
Это означает, что реплики одной и той же информации, распределенные по разным серверам друг другу, не противоречат друг
другу и любой запрос к распределённой системе завершается корректным откликом.

3 - CP-система (Consistency + Partition tolerance – Availability) в каждый момент обеспечивает целостность данных и 
способна работать в условиях распада в ущерб доступности, не выдавая отклик на запрос. Устойчивость к разделению требует
дублирования изменений во всех узлах системы, что реализуется с помощью распределённых пессимистических блокировок для 
сохранения целостности. По сути, CP – это система с несколькими синхронно обновляемыми мастер-базами. Она всегда корректна,
отрабатывая транзакцию, только в том случае, если изменения удалось распространить по всем серверам. 
Она продолжает корректно читать данные даже при отказе одного из узлов кластера. Но в этом случае запись будет обрываться 
или сильно задерживаться, пока система не убедится в своей целостности и согласованности (консистентности).

AP - PA/EL

СА - EL/PC

PC - PA/EC

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

Ответ:

Теорема CAP утверждает, что невозможно достичь как согласованности, так и доступности в распределенной системе, 
устойчивой к разбиению (т. е. системе, которая продолжает работать в случае временных сбоев связи).
Фундаментальное различие между моделями баз данных ACID и BASE заключается в том, как они справляются с этим ограничением.
Модель ACID обеспечивает согласованную систему.  Модель BASE обеспечивает высокую доступность.
ACID-совместимые базы данных, учитывая их высокоструктурированный характер, больше подходят тем, кому требуются 
согласованность,предсказуемость и надежность.
Те, кто считает рост одним из своих приоритетов, вероятно, захотят выбрать модель BASE, поскольку она упрощает 
масштабирование и обеспечивает большую гибкость. Получить все сразу и в одном флаконе - банально не выйдет. 

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

* фиксация некоторых значений с временем жизни
* реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub. Что это за система? Какие минусы выбора данной системы?

Ответ:
Redis

Redis вообще-то не pub-sub система, а key-value data storage. Он хорошо реализует классический pub-sub и показывает 
замечательную производительность.
Мы можем установить Redis локальй или как распределенный сервис, также добавить возможность сохранения сообщений на диск.

ПЛЮСЫ:

Redis поставляются в бинарном и исходном виде и их можно установить на любых серверных платформах: Windows, Linux, Mac. 
Redis довольно новая системы и постоянно находятся в стадии усовершенствований. Это накладывает свою специфику
именно в отношении надежности.

МИНУСЫ:

Необходимо контролировать количестпо оперативной памяти, достаточное для работы Redis.
Соответственно при отказе сервера все данные с последней синхронизации с диском будут утеряны.


